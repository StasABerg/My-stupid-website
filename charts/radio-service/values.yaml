replicaCount: 2

image:
  registry: ghcr.io
  repository: stasaberg/radio-service
  tag: ""
  pullPolicy: IfNotPresent

nameOverride: ""
fullnameOverride: "my-stupid-website-radio"

serviceAccount:
  create: false
  name: ""

podAnnotations: {}
podLabels: {}

podSecurityContext:
  runAsNonRoot: true
  fsGroup: 101
  seccompProfile:
    type: RuntimeDefault

securityContext:
  runAsUser: 101
  runAsGroup: 101
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  seccompProfile:
    type: RuntimeDefault

service:
  type: ClusterIP
  port: 4010
  targetPort: 4010

containerPort: 4010

gateway:
  enabled: false
  parentRefs:
    - name: contour-gateway
      namespace: contour
      sectionName: http
    - name: contour-gateway
      namespace: contour
      sectionName: https
  hostnames: []
  paths:
    - value: /radio
      type: PathPrefix
  middlewareRefs: []

env:
  - name: REDIS_URL
    valueFrom:
      secretKeyRef:
        name: radio-service-env
        key: REDIS_URL
        optional: true
  - name: PG_URL
    valueFrom:
      secretKeyRef:
        name: radio-service-env
        key: PG_URL
  - name: PG_USER
    valueFrom:
      secretKeyRef:
        name: radio-service-env
        key: PG_USER
        optional: true
  - name: PG_PASS
    valueFrom:
      secretKeyRef:
        name: radio-service-env
        key: PG_PASS
        optional: true
  - name: STATIONS_CACHE_TTL
    value: "3600"
  - name: STATIONS_MEMORY_CACHE_TTL
    value: "5"
  - name: STATIONS_CACHE_KEY
    valueFrom:
      secretKeyRef:
        name: radio-service-env
        key: STATIONS_CACHE_KEY
        optional: true
  - name: STATIONS_REFRESH_TOKEN
    valueFrom:
      secretKeyRef:
        name: radio-service-env
        key: STATIONS_REFRESH_TOKEN
        optional: false
  - name: ALLOW_INSECURE_TRANSPORT
    value: "true"
  - name: RADIO_BROWSER_LIMIT
    value: "60000"
  - name: RADIO_BROWSER_PAGE_SIZE
    value: "500"
  - name: RADIO_BROWSER_MAX_PAGES
    value: "200"
  - name: RADIO_BROWSER_USER_AGENT
    value: "gitgud.zip blog"
  - name: STREAM_VALIDATION_CONCURRENCY
    value: "64"
  - name: TRUST_PROXY
    value: loopback,linklocal,uniquelocal

initContainers: []

resources:
  requests:
    cpu: 50m
    memory: 512Mi
  limits:
    cpu: 1000m
    memory: 1Gi

autoscaling:
  enabled: true
  minReplicas: 1
  maxReplicas: 4
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 75
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 0
      selectPolicy: Max
      policies:
        - type: Percent
          value: 100
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
    scaleDown:
      stabilizationWindowSeconds: 300
      selectPolicy: Max
      policies:
        - type: Percent
          value: 40
          periodSeconds: 60

logLevel: info

livenessProbe:
  httpGet:
    path: /healthz
    port: http
  initialDelaySeconds: 10
  periodSeconds: 15

readinessProbe:
  httpGet:
    path: /healthz
    port: http
  initialDelaySeconds: 5
  periodSeconds: 10

nodeSelector: {}
tolerations: []
affinity: {}
